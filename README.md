# TAW (Tmux + Agent + Worktree)

Claude Code ê¸°ë°˜ì˜ í”„ë¡œì íŠ¸ ê´€ë¦¬ ì‹œìŠ¤í…œì…ë‹ˆë‹¤.

## ê°œìš”

- ì•„ë¬´ ë””ë ‰í† ë¦¬ì—ì„œ `taw` ëª…ë ¹ì–´ë¡œ tmux ì„¸ì…˜ ê¸°ë°˜ì˜ ì‘ì—… í™˜ê²½ì„ ì‹œì‘í•©ë‹ˆë‹¤.
- íƒœìŠ¤í¬ë¥¼ ìƒì„±í•˜ë©´ ìë™ìœ¼ë¡œ Claude Code agentê°€ ì‹œì‘ë©ë‹ˆë‹¤.
- **Git ëª¨ë“œ**: git ë ˆí¬ì—ì„œ ì‹¤í–‰ ì‹œ íƒœìŠ¤í¬ë§ˆë‹¤ worktree ìë™ ìƒì„±
- **Non-Git ëª¨ë“œ**: git ì—†ì´ë„ ì‚¬ìš© ê°€ëŠ¥ (worktree ì—†ì´ í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì‘ì—…)

## ì„¤ì¹˜

```bash
./install    # ~/.local/bin/taw ì„¤ì¹˜
./uninstall  # ~/.local/bin/taw ì œê±°
```

## ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
taw/                           # ì´ ë ˆí¬
â”œâ”€â”€ install                    # taw ì„¤ì¹˜
â”œâ”€â”€ uninstall                  # taw ì œê±°
â””â”€â”€ _taw/                      # ì „ì—­ ì„¤ì •
    â”œâ”€â”€ PROMPT.md              # ì „ì—­ ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸ (git ëª¨ë“œ)
    â”œâ”€â”€ PROMPT-nogit.md        # ì „ì—­ ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸ (non-git ëª¨ë“œ)
    â”œâ”€â”€ HELP.md                # ë„ì›€ë§ (âŒ¥ + / ë¡œ ì—´ëŒ)
    â”œâ”€â”€ bin/                   # ì‹¤í–‰ íŒŒì¼
    â”‚   â”œâ”€â”€ taw                # ë©”ì¸ ëª…ë ¹ì–´ (ì„¸ì…˜ ì‹œì‘)
    â”‚   â”œâ”€â”€ setup              # ì´ˆê¸° ì„¤ì • ë§ˆë²•ì‚¬
    â”‚   â”œâ”€â”€ new-task           # íƒœìŠ¤í¬ ìƒì„±
    â”‚   â”œâ”€â”€ handle-task        # íƒœìŠ¤í¬ ì²˜ë¦¬ (worktree ìƒì„±, agent ì‹œì‘)
    â”‚   â”œâ”€â”€ end-task           # íƒœìŠ¤í¬ ì¢…ë£Œ (^x)
    â”‚   â”œâ”€â”€ attach             # íƒœìŠ¤í¬ ì¬ì—°ê²°
    â”‚   â”œâ”€â”€ cleanup            # ì •ë¦¬ ìŠ¤í¬ë¦½íŠ¸ (/doneì—ì„œ ì‚¬ìš©)
    â”‚   â”œâ”€â”€ quick-task         # ë¹ ë¥¸ íƒœìŠ¤í¬ í ì¶”ê°€ (^âŒ¥a)
    â”‚   â”œâ”€â”€ popup-shell        # íŒì—… ì‰˜ (^aë¡œ í† ê¸€)
    â”‚   â”œâ”€â”€ process-queue      # í ì²˜ë¦¬ (íƒœìŠ¤í¬ ì™„ë£Œ í›„ ìë™ ì‹¤í–‰)
    â”‚   â””â”€â”€ _common.sh         # ê³µí†µ ìœ í‹¸ë¦¬í‹° (ìƒìˆ˜, í•¨ìˆ˜, ì„¤ì •)
    â””â”€â”€ claude/commands/       # slash commands
        â”œâ”€â”€ commit.md          # /commit - ìŠ¤ë§ˆíŠ¸ ì»¤ë°‹
        â”œâ”€â”€ test.md            # /test - í…ŒìŠ¤íŠ¸ ì‹¤í–‰
        â”œâ”€â”€ pr.md              # /pr - PR ìƒì„±
        â”œâ”€â”€ merge.md           # /merge - ë¸Œëœì¹˜ ë¨¸ì§€
        â”œâ”€â”€ finish.md          # /finish - íƒœìŠ¤í¬ ì™„ë£Œ
        â””â”€â”€ done.md            # /done - íƒœìŠ¤í¬ ì •ë¦¬

{any-project}/                 # ì‚¬ìš©ì í”„ë¡œì íŠ¸ (git ë˜ëŠ” ì¼ë°˜ ë””ë ‰í† ë¦¬)
â””â”€â”€ .taw/                      # tawê°€ ìƒì„±í•˜ëŠ” ë””ë ‰í† ë¦¬
    â”œâ”€â”€ config                 # í”„ë¡œì íŠ¸ ì„¤ì • (YAML, ì´ˆê¸° ì„¤ì • ì‹œ ìƒì„±)
    â”œâ”€â”€ PROMPT.md              # í”„ë¡œì íŠ¸ë³„ í”„ë¡¬í”„íŠ¸
    â”œâ”€â”€ .global-prompt         # -> ì „ì—­ í”„ë¡¬í”„íŠ¸ (symlink, git ëª¨ë“œì— ë”°ë¼ ë‹¤ë¦„)
    â”œâ”€â”€ .is-git-repo           # git ëª¨ë“œ ë§ˆì»¤ (git ë ˆí¬ì¼ ë•Œë§Œ ì¡´ì¬)
    â”œâ”€â”€ .claude                # -> _taw/claude (symlink)
    â”œâ”€â”€ .metadata/             # ë¡œê·¸ ë° ìƒíƒœ
    â”œâ”€â”€ .queue/                # ë¹ ë¥¸ íƒœìŠ¤í¬ í (^âŒ¥aë¡œ ì¶”ê°€)
    â”‚   â””â”€â”€ 001.task           # ëŒ€ê¸° ì¤‘ì¸ íƒœìŠ¤í¬ (ìˆœì„œëŒ€ë¡œ ì²˜ë¦¬)
    â””â”€â”€ agents/{task-name}/    # íƒœìŠ¤í¬ë³„ ì‘ì—… ê³µê°„
        â”œâ”€â”€ task               # íƒœìŠ¤í¬ ë‚´ìš©
        â”œâ”€â”€ log                # ì§„í–‰ ë¡œê·¸
        â”œâ”€â”€ attach             # íƒœìŠ¤í¬ ì¬ì—°ê²° ìŠ¤í¬ë¦½íŠ¸
        â”œâ”€â”€ origin             # -> í”„ë¡œì íŠ¸ ë£¨íŠ¸ (symlink)
        â”œâ”€â”€ worktree/          # git worktree (git ëª¨ë“œì—ì„œë§Œ ìë™ ìƒì„±)
        â”œâ”€â”€ .tab-lock/         # íƒ­ ìƒì„± ë½ (atomic mkdirë¡œ race condition ë°©ì§€)
        â”‚   â””â”€â”€ window_id      # tmux window ID (cleanupì—ì„œ ì‚¬ìš©)
        â””â”€â”€ .pr                # PR ë²ˆí˜¸ (ìƒì„± ì‹œ)
```

## ì‚¬ìš©ë²•

### í”„ë¡œì íŠ¸ì—ì„œ taw ì‹œì‘

```bash
cd /path/to/your/project  # git ë ˆí¬ ë˜ëŠ” ì¼ë°˜ ë””ë ‰í† ë¦¬
taw  # .taw ë””ë ‰í† ë¦¬ ìƒì„± ë° tmux ì„¸ì…˜ ì‹œì‘ â†’ ìë™ìœ¼ë¡œ new-task ì‹¤í–‰
```

- git ë ˆí¬ì—ì„œ ì‹¤í–‰: Git ëª¨ë“œ (worktree ìë™ ìƒì„±)
- ì¼ë°˜ ë””ë ‰í† ë¦¬ì—ì„œ ì‹¤í–‰: Non-Git ëª¨ë“œ (í”„ë¡œì íŠ¸ ë””ë ‰í† ë¦¬ì—ì„œ ì§ì ‘ ì‘ì—…)

ì²« ì‹œì‘ ì‹œ ìë™ìœ¼ë¡œ íƒœìŠ¤í¬ ì‘ì„± ì—ë””í„°ê°€ ì—´ë¦½ë‹ˆë‹¤.

### íƒœìŠ¤í¬ ìƒì„±

ì¶”ê°€ íƒœìŠ¤í¬ ìƒì„±ì´ í•„ìš”í•˜ë©´ tmux ì„¸ì…˜ ë‚´ì—ì„œ:
```bash
.taw/new-task  # $EDITORì—ì„œ íƒœìŠ¤í¬ ì‘ì„± â†’ ìë™ìœ¼ë¡œ agent ì‹œì‘
```

vi/vim/nvim ì‚¬ìš© ì‹œ ìë™ìœ¼ë¡œ insert ëª¨ë“œë¡œ ì‹œì‘í•©ë‹ˆë‹¤.

### Slash Commands

Agentê°€ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ” slash commands:

| Command | ì„¤ëª… |
|---------|------|
| `/commit` | ìŠ¤ë§ˆíŠ¸ ì»¤ë°‹ (diff ë¶„ì„ í›„ ë©”ì‹œì§€ ìë™ ìƒì„±) |
| `/test` | í”„ë¡œì íŠ¸ í…ŒìŠ¤íŠ¸ ìë™ ê°ì§€ ë° ì‹¤í–‰ |
| `/pr` | PR ìë™ ìƒì„± ë° ë¸Œë¼ìš°ì € ì—´ê¸° |
| `/merge` | worktree ë¸Œëœì¹˜ë¥¼ í”„ë¡œì íŠ¸ì˜ í˜„ì¬ ë¸Œëœì¹˜ì— ë¨¸ì§€ |
| `/finish` | íƒœìŠ¤í¬ ì™„ë£Œ (commit â†’ PR â†’ ìƒíƒœ ì—…ë°ì´íŠ¸) |
| `/done` | íƒœìŠ¤í¬ ì •ë¦¬ (worktree, branch, ë””ë ‰í† ë¦¬, window) |

### ë¶ˆì™„ì „í•œ íƒœìŠ¤í¬ ìë™ ì¬ì˜¤í”ˆ

íƒœìŠ¤í¬ê°€ ì™„ë£Œë˜ì§€ ì•Šì€ ìƒíƒœ(done ì²˜ë¦¬ë˜ì§€ ì•ŠìŒ)ì—ì„œ windowê°€ ë‹«íˆê±°ë‚˜ tmux ì„¸ì…˜ì´ ì¢…ë£Œëœ ê²½ìš°, ë‹¤ìŒì— `taw`ë¥¼ ì‹¤í–‰í•˜ë©´ ìë™ìœ¼ë¡œ í•´ë‹¹ íƒœìŠ¤í¬ë“¤ì˜ windowë¥¼ ë‹¤ì‹œ ì—´ì–´ì¤ë‹ˆë‹¤.

- ìƒˆ ì„¸ì…˜ ì‹œì‘ ì‹œì™€ ê¸°ì¡´ ì„¸ì…˜ ì¬ì—°ê²° ì‹œ ëª¨ë‘ ìë™ìœ¼ë¡œ ê°ì§€
- Claudeì— ìƒˆë¡œìš´ ì…ë ¥ì„ ë³´ë‚´ì§€ ì•Šê³  ì´ì „ ìƒíƒœ ê·¸ëŒ€ë¡œ ë³µì›
- ìˆ˜ë™ìœ¼ë¡œ ì´ì–´ì„œ ì‘ì—…í•  ìˆ˜ ìˆë„ë¡ ì¤€ë¹„ë¨

### Window ìƒíƒœ

- ğŸ¤– ì‘ì—… ì¤‘
- ğŸ’¬ ëŒ€ê¸° ì¤‘
- âœ… ì™„ë£Œ

## ì„¤ì •

### ì´ˆê¸° ì„¤ì • (Initial Setup)

ì²˜ìŒ `taw`ë¥¼ ì‹¤í–‰í•˜ë©´ ì„¤ì • ë§ˆë²•ì‚¬ê°€ ë‚˜íƒ€ë‚©ë‹ˆë‹¤:

```
=== TAW Initial Setup ===

Work Mode
How should taw create working directories for tasks?

  â†’ 1) worktree - Create git worktree per task (isolated, recommended)
    2) main     - Work directly on current branch (simpler)

Select [1-2, default: 1]:
```

ì„¤ì •ì€ `.taw/config` íŒŒì¼ì— YAML í˜•ì‹ìœ¼ë¡œ ì €ì¥ë©ë‹ˆë‹¤.

### ì„¤ì • ì¬ì‹¤í–‰

```bash
taw setup  # ì„¤ì • ë§ˆë²•ì‚¬ ë‹¤ì‹œ ì‹¤í–‰
```

### ì„¤ì • íŒŒì¼ (.taw/config)

```yaml
# TAW Configuration
# Edit this file directly to change settings

# Work Mode (git repositories only)
# Options: worktree | main
#   worktree - Create a git worktree per task (recommended)
#   main     - Work directly on current branch
work_mode: worktree

# On Complete Behavior
# Options: confirm | auto-commit | auto-merge | auto-pr
#   confirm     - Ask before each action (commit, merge, PR)
#   auto-commit - Automatically commit changes (manual merge/PR)
#   auto-merge  - Auto commit + merge to current branch
#   auto-pr     - Auto commit + create Pull Request (for teams)
on_complete: confirm
```

### ì„¤ì • ì˜µì…˜

| ì„¤ì • | ì˜µì…˜ | ì„¤ëª… |
|------|------|------|
| `work_mode` | `worktree` | íƒœìŠ¤í¬ë§ˆë‹¤ git worktree ìƒì„± (ê²©ë¦¬, ê¶Œì¥) |
|             | `main` | í˜„ì¬ ë¸Œëœì¹˜ì—ì„œ ì§ì ‘ ì‘ì—… (ë‹¨ìˆœ) |
| `on_complete` | `confirm` | ê° ì‘ì—… ì „ í™•ì¸ (ì•ˆì „) |
|               | `auto-commit` | ìë™ ì»¤ë°‹ (ë¨¸ì§€/PRì€ ìˆ˜ë™) |
|               | `auto-merge` | ìë™ ì»¤ë°‹ + í˜„ì¬ ë¸Œëœì¹˜ì— ë¨¸ì§€ |
|               | `auto-pr` | ìë™ ì»¤ë°‹ + PR ìƒì„± (íŒ€ í˜‘ì—…ìš©) |

### ê¸°íƒ€ ì„¤ì •

- `_taw/PROMPT.md`: ì „ì—­ ì—ì´ì „íŠ¸ í”„ë¡¬í”„íŠ¸
- `.taw/PROMPT.md`: í”„ë¡œì íŠ¸ë³„ í”„ë¡¬í”„íŠ¸ (ê° í”„ë¡œì íŠ¸ ë‚´)
- `_taw/claude/commands/`: slash commands
- `EDITOR` í™˜ê²½ë³€ìˆ˜: íƒœìŠ¤í¬ ì‘ì„± ì—ë””í„° (ê¸°ë³¸: vim)

## ì˜ì¡´ì„±

```bash
brew install tmux gh
```

## tmux ë‹¨ì¶•í‚¤

| ë™ì‘ | ë‹¨ì¶•í‚¤ |
|------|--------|
| íŒì—… ì‰˜ | `^a` (í˜„ì¬ worktreeì—ì„œ ì‰˜ ì—´ê¸°/ë‹«ê¸°) |
| ìƒˆ íƒœìŠ¤í¬ | `^n` |
| íƒœìŠ¤í¬ ì¢…ë£Œ | `^x` (worktree/branch ì •ë¦¬ ë° ì°½ ë‹«ê¸°) |
| ë¹ ë¥¸ íƒœìŠ¤í¬ í ì¶”ê°€ | `^âŒ¥a` (í˜„ì¬ íƒœìŠ¤í¬ ì™„ë£Œ í›„ ìë™ ì²˜ë¦¬) |
| Pane ì´ë™ | `âŒ¥ + â†/â†’/â†‘/â†“` |
| Pane ë¶„í•  | `âŒ¥ + h/j/k/l` (ì¢Œ/í•˜/ìƒ/ìš°) |
| Pane ë‹«ê¸° | `âŒ¥ + x` |
| Window ì´ë™ | `â‡§âŒ¥ + â†/â†’` |
| ë„ì›€ë§ | `âŒ¥ + /` |
| Session ë‚˜ê°€ê¸° | `^q` (detach) |

## ë¹ ë¥¸ íƒœìŠ¤í¬ í

ì‘ì—… ì¤‘ì— ë– ì˜¤ë¥¸ ì•„ì´ë””ì–´ë‚˜ ì¶”ê°€ ì‘ì—…ì„ ë¹ ë¥´ê²Œ íì— ì¶”ê°€í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.

1. `^âŒ¥a`ë¥¼ ëˆ„ë¥´ë©´ íŒì—…ì´ ì—´ë¦½ë‹ˆë‹¤
2. íƒœìŠ¤í¬ ë‚´ìš©ì„ ì…ë ¥í•˜ê³  Enter
3. í˜„ì¬ íƒœìŠ¤í¬ê°€ ì™„ë£Œ(`/finish` ë˜ëŠ” `/done`)ë˜ë©´ íì— ìˆëŠ” íƒœìŠ¤í¬ê°€ ìë™ìœ¼ë¡œ ì‹œì‘ë©ë‹ˆë‹¤

í ê´€ë¦¬:
```bash
.taw/.queue/      # í ë””ë ‰í† ë¦¬
â””â”€â”€ 001.task      # ëŒ€ê¸° ì¤‘ì¸ íƒœìŠ¤í¬ íŒŒì¼
```
